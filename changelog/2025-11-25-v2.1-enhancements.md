# v2.1.0 - 功能增强与优化

**日期**: 2025-11-25

## 概述

对网页版进行全面增强，添加多个新组件、自定义 Hooks、PWA 支持，优化移动端体验。

## 新增功能

### 组件

- **Toast 通知组件** - 全局消息提示，支持 success/error/info/warning 四种类型
- **Loading 组件** - 加载状态、遮罩、骨架屏组件
- **Modal 对话框** - 通用弹窗和确认框组件
- **QuickRecord 快捷记录** - 首页快速记录今日心情
- **StatsCard 统计卡片** - 包含分布条形图和年度热力图

### Hooks

- **useDebounce** - 防抖值和防抖回调
- **useMediaQuery** - 响应式媒体查询
- **useIsMobile / useIsTablet / useIsDesktop** - 设备类型判断
- **usePrefersDark** - 系统深色模式偏好

### API 客户端

- 封装统一的 API 请求方法 (get/post/put/delete)
- 自动携带认证令牌
- 请求超时处理
- 统一错误处理 (ApiError)

### PWA 支持

- 添加 manifest.json
- 添加 Apple 移动端 meta 标签
- 支持添加到主屏幕
- 全屏模式运行

## 功能增强

### 日历页面

- 添加快捷记录组件，支持一键记录今日心情
- 移动端快捷记录显示在顶部，桌面端显示在日历下方
- 优化响应式布局

### 统计页面

- 新增年度热力图，可切换查看不同年份
- 新增月度柱状图统计
- 新增心情分布条形图（百分比展示）
- 优化数据可视化效果

### 移动端优化

- 添加安全区域适配 (safe-area)
- 优化触摸反馈效果
- 移动端日历格子缩小适配
- 禁用不必要的缩放

## 样式优化

- 新增 slide-up 动画（Toast）
- 新增 scale-in 动画（Modal）
- 优化滚动条样式
- 添加 touch-feedback 触摸反馈类
- 添加 no-select 禁止选择类

## 代码质量

- 抽离公共组件，提高复用性
- 统一 API 调用方式
- 添加 TypeScript 类型定义
- 遵循 KISS 原则，保持代码简洁

## 文件变更

### 新增文件

- `apps/web/src/lib/api.ts` - API 客户端
- `apps/web/src/components/Toast.tsx` - Toast 组件
- `apps/web/src/components/Loading.tsx` - Loading 组件
- `apps/web/src/components/Modal.tsx` - Modal 组件
- `apps/web/src/components/QuickRecord.tsx` - 快捷记录组件
- `apps/web/src/components/StatsCard.tsx` - 统计卡片组件
- `apps/web/src/hooks/useDebounce.ts` - 防抖 Hook
- `apps/web/src/hooks/useMediaQuery.ts` - 媒体查询 Hook
- `apps/web/src/hooks/index.ts` - Hooks 导出
- `apps/web/public/manifest.json` - PWA 配置

### 修改文件

- `apps/web/index.html` - 添加 PWA meta 标签
- `apps/web/src/index.css` - 添加动画和移动端样式
- `apps/web/src/main.tsx` - 集成 ToastProvider
- `apps/web/src/pages/Calendar.tsx` - 添加快捷记录
- `apps/web/src/pages/Stats.tsx` - 增强统计功能

## 下一步计划

- 添加 Service Worker 离线缓存
- 添加数据加密功能
- 添加更多导出格式
- 优化首次加载性能
